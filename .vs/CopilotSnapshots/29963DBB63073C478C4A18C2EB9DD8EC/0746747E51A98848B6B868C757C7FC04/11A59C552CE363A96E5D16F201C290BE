using Microsoft.AspNetCore.Mvc;
using SPSUL.Models.Data;
using System.Linq;

namespace SPSUL.Controllers
{
    public class StudentsController : Controller
    {
        // Demo data source (replace later with DB)
        private static readonly List<Student> _students = new()
        {
            new Student{ StudentId=1, FirstName="Julius", LastName="Novák", IsActive=true },
            new Student{ StudentId=2, FirstName="Eva", LastName="Černá", IsActive=true },
            new Student{ StudentId=3, FirstName="Petr", LastName="Bílý", IsActive=false },
            new Student{ StudentId=4, FirstName="Anna", LastName="Malá", IsActive=true },
        };

        public IActionResult Index(string? q, bool? active)
        {
            var query = _students.AsQueryable();
            if (!string.IsNullOrWhiteSpace(q))
            {
                var text = q.ToLower();
                query = query.Where(s => s.FirstName.ToLower().Contains(text) || s.LastName.ToLower().Contains(text));
            }
            if (active.HasValue)
            {
                query = query.Where(s => s.IsActive == active.Value);
            }
            var model = query.OrderBy(s => s.LastName).ThenBy(s => s.FirstName).ToList();
            return View(model);
        }
    }
}
